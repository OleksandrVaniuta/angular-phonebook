import{a as u,b as m}from"./chunk-TKBHC6Y7.js";import{C as o,V as i,Z as c,da as h,n,o as l}from"./chunk-GBCURD4M.js";var y=(()=>{let r=class r{constructor(e){this.http=e,this.isAuthenticated=!1,this.baseUrl="https://connections-api.herokuapp.com/users",this.tokenKey="authToken"}login(e){return this.http.post(`${this.baseUrl}/login`,e).pipe(i(t=>(console.log("Login successful",t),t.token&&(this.isAuthenticated=!0,localStorage.setItem(this.tokenKey,t.token),localStorage.setItem("user",t.user.email)),t)),o(this.handleError))}signup(e){return this.http.post(`${this.baseUrl}/signup`,e).pipe(i(t=>(console.log("Login successful",t),t.token&&(this.isAuthenticated=!0,localStorage.setItem(this.tokenKey,t.token),localStorage.setItem("user",t.user.email)),t)),o(this.handleError))}isAuthenticatedUser(){return n(!!localStorage.getItem(this.tokenKey))}getToken(){return localStorage.getItem(this.tokenKey)}logout(){this.isAuthenticated=!1,localStorage.removeItem(this.tokenKey)}refresh(){let e=localStorage.getItem("authToken"),t=new u({"Content-Type":"application/json",Authorization:`Bearer ${e}`});return this.http.get(`${this.baseUrl}/current`,{headers:t}).pipe(i(a=>(localStorage.setItem("user",a.email),a)),o(this.handleError))}handleError(e){return e.status===0?console.error("An error occurred:",e.error):console.error(`Backend returned code ${e.status}, body was: `,e.error),l(()=>new Error("bad request"))}};r.\u0275fac=function(t){return new(t||r)(h(m))},r.\u0275prov=c({token:r,factory:r.\u0275fac,providedIn:"root"});let s=r;return s})();export{y as a};
